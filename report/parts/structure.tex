\section{Structure du projet :}

\subsection{Structure graphique Android et navigation :} \label{navig}
Pour afficher certains éléments d'interface comme par exemple les informations de l'image (bouton \faInfoCircle) ou les paramètres d'effet nous utilisons des \textbf{Fragment}. En effet une activité supplémentaire n'est pas nécessaire car cette petite partie de l'application ne correspond pas à un point d'entrée de l'application. Par ailleurs changer de fragment (plutôt que de changer directement de layout) pourrait faciliter l'implémentation d'une interface différente, pour tablette par exemple.
\\

On notera que dans la structure actuelle de l'application, l'image actuellement éditée est contenue et manipulée depuis l'activité principale. Les fragments n'apportent à l'application que des éléments d'interface. Seul le fragment d'information se voit transmettre un objet ImageInfo, il implémente donc l'interface \textbf{Parcelable}. (voir \ref{parcelable})
\\

Une seconde activité est cependant utilisée pour la page d'accueil à l'ouverture de l'application, cette \textbf{FirstActivity} utilise des méthodes génériques de \textbf{ActivityIO} afin de gérer l'ouverture de la galerie ou de la caméra. L'application reste dans cette activité tant qu'une \textbf{Uri} valable ($\approx$ chemin) n'a pas été sélectionnée. Ensuite cette Uri est transférée à \textbf{MainActivity} qui va alors charger cette première Image, en cas de problème de chargement l'application peut retourner dans FirstActivity.

\subsection{Classe \textbf{Image} :} \label{classeImage}
Cette classe a été conçu comme une alternative à l'utilisation directe de la classe \textbf{Bitmap} fournie par Android.
\\
Le coeur de la classe est évidement une instance de Bitmap, qu'il est possible de récupérer à tout moment. Par ailleurs la classe offre des fonctionnalités supplémentaires, parmi celle ci notamment la possibilité de restaurer l'image à son état au moment de sa création ou de son chargement, ou alors de faire une sauvegarde rapide de son état et de le restaurer.
\\
Un autre objectif de cette classe était d'en faire une fonctionnalité facilement exportable sur un autre projet, c'est pourquoi elle offre une interface de manipulation d'une Bitmap tout en restant très indépendante du reste du code. De même de nombreux constructeurs sont disponibles mais pas encore utilisés, ils permettent de charger une image de plusieurs façon et avec des tailles différentes.

\subsubsection{Classe \textbf{ImageInfo} :}
La classe Image \ref{classeImage} génère et garde une instance de la classe \textbf{ImageInfo}, cette classe contient un grand nombre de valeurs à propos de l'Image (dimensions, coordonnées GPS, date de prise de vue, ...).
\\
L'idée de cette classe était d'empaqueter toutes ces informations afin de faciliter le passage de ces informations à travers des Fragments ou des Activités (voir \ref{navig}). On notera que tous les accesseurs appliquent des opérations de formatage sur ces données, certaines opérations pourraient être déplacées dans les constructeurs si elles venaient à être utilisées régulièrement.

\subsection{AsyncTasks}
Les 3 classes du package \textbf{fr.ubordeaux.pimp.task} héritent de la classe Android \textbf{AsyncTask} et permettent d'exécuter certaines opérations en arrière plan, donc sans bloquer l'interface utilisateur.
\\
Ainsi \textbf{LoadImageUriTask} et \textbf{ApplyFilterQueueTask} permettent respectivement de charger une image et de l'exporter, elles s'occupent d'afficher un petit logo de chargement et de lancer les calculs.
\\
\textbf{ApplyEffectTask} est un peu différente, elle permet de mettre en arrière plan le calcul d'application d'un effet. Elle fonctionne pour n'importe quel effet, pour ce faire elle a besoin d'un paramètre, le type d'effet sous la forme d'un \textbf{Runnable}.

\subsection{Packages utilitaires :}
De nombreuses classes du code permettent une factorisation et une clarification du code en offrant des méthodes pratiques, généralement statiques. Parmi ces classes on pourra retrouver:
\\

La classe \textbf{Utils} qui offre des méthodes pour récupérer la taille de l'écran, pour calculer un ratio de redimensionnement, pour manipuler des chemins d'image ou régler des problèmes d'orientation d'image.
\\

La classe \textbf{BitmapIO} permet d'effectuer le chargement d'une Bitmap de plusieurs manières, depuis les resources ou un autre emplacement du téléphone, et avec la taille voulue.
\\

La classe \textbf{ActivityIO} permet de gérer l'ouverture de l'application de galerie ou de caméra et d'en récupérer le retour, le tout en gérant les permissions de l'application.
\\

Enfin la classe \textbf{Kernels} offre des méthodes de génération de noyau de convolution permettant afin de créer différents effets.
